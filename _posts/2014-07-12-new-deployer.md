---
layout: post
title: Большое обновление Deployer
---

Последнюю неделю активно занимался развитием инструмента для деплоя [Deployer](http://deployer.org).
Также обновил сайт и написал более хорошую документацию.

![Deployer](/assets/new-deployer/deployer.png)

<!--more-->

Теперь вместе с деплоером идут рецепты. Таким образом, можно легко резвернуть свой Symfony2 проект на сервере:


~~~ php
require 'recipe/symfony.php';

server('main', 'site.com')
    ->path('/home/user/site.com')
    ->user('user')
    ->pubKey();

set('repository', 'git@github.com:user/site.git');
~~~

Deployer также можно установить через Composer или через phar архив.
Но теперь поддерживается автоматическое обновление phar архива.

~~~
dep self-update
~~~

Одно из самых больших нововведений- это то, что теперь таски выполняются не последовательно, а сериями.

Если раньше таски выполнялись так:

~~~
Сервер 1
    Таск 1
    Таск 2
    Таск 3
Сервер 2
    Таск 1
    Таск 2
    Таск 3
~~~

То теперь они выполняются сериями:

~~~
Таск 1
    Сервер 1
    Сервер 2
Таск 2
    Сервер 1
    Сервер 2
Таск 3
    Сервер 1
    Сервер 2
~~~

Таким образом, если в одном из тасков происходит какая-либо ошибка, то выполнение деплоя останавливается на всех серверах
и все сервера остаются в согласованном состоянии.

